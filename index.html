<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Interest Calculator</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet" />
<style>
  :root{
    --card-bg: #fff;
    --accent: #4caf50;
    --shadow: rgba(0,0,0,0.08);
    --max-width: 420px;
    --gap: 12px;
  }

  /* Page */
  body {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height: 100vh;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(#84adbe, #04465f);
    padding: 20px;
    box-sizing: border-box;
  }

  /* Card / Calculator */
  .calculator {
    background-color: var(--card-bg);
    padding: 18px;
    border-radius: 10px;
    margin-bottom: 16px;
    width: 100%;
    max-width: var(--max-width);
    box-shadow: 0 6px 18px var(--shadow);
    box-sizing: border-box;
  }
  .calculator h1 {
    font-size: 18px;
    margin-bottom: 10px;
    text-align: center;
  }

  /* Input groups */
  .input-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    justify-content: space-between;
    gap: 8px;
  }
  .input-group label {
    width: 36%;
    font-size: 14px;
  }
  .input-group input[type="text"],
  .input-group input[type="date"] {
    width: 62%;
    padding: 8px 10px;
    border-radius: 6px;
    border: 1px solid #ddd;
    font-size: 14px;
    box-sizing: border-box;
  }

  /* Buttons and small elements */
  .submit-btn {
    padding: 10px 12px;
    background-color: var(--accent);
    color: white;
    border: none;
    cursor: pointer;
    width: 100%;
    border-radius: 8px;
    font-weight: 600;
    font-size: 15px;
  }
  .checkboxes {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 8px;
    flex-wrap: wrap;
  }
  .checkboxes label {
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  #output { font-weight: 600; margin-top: 10px; font-size: 14px; line-height:1.45; word-break: break-word; }
  #periodOutput { font-weight: 600; margin-top: 8px; font-size: 14px; text-align:center; }
  .small { font-size: 12px; color: #444; text-align:center; }

  hr.responsive {
    border: none;
    border-top: 1px solid #eee;
    margin: 10px 0;
  }

  /* Responsive adjustments for small screens */
  @media (max-width: 520px) {
    :root{ --max-width: 420px; }

    body { padding: 14px; }

    .calculator {
      padding: 14px;
      border-radius: 10px;
    }

    .calculator h1 { font-size: 16px; }

    .input-group {
      flex-direction: column;
      align-items: stretch;
    }
    .input-group label {
      width: 100%;
      margin-bottom: 6px;
      font-size: 13px;
    }
    .input-group input[type="text"],
    .input-group input[type="date"] {
      width: 100%;
      font-size: 15px;
      padding: 10px;
    }

    .checkboxes {
      flex-direction: column;
      align-items: flex-start;
      gap: 8px;
    }

    .small { font-size: 12px; }

    #output { font-size: 15px; }
  }

  /* Extra small - fine tuning */
  @media (max-width: 360px) {
    .calculator { padding: 12px; }
    .submit-btn { padding: 10px; font-size: 14px; }
    .input-group input[type="text"], .input-group input[type="date"] { padding: 9px; font-size: 14px; }
    .calculator h1 { font-size: 15px; }
  }
</style>
</head>
<body>

<!-- Time Period Calculator -->
<div class="calculator">
  <h1>Time Period Calculator</h1>
  <div class="input-group">
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate" />
  </div>
  <div class="input-group">
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate" />
  </div>
  <button class="submit-btn" onclick="calculatePeriod()">Calculate Period</button>
  <div id="periodOutput"></div>
</div>

<!-- Interest Calculator -->
<div class="calculator">
  <h1>Interest Calculator</h1>

  <div class="checkboxes">
    <label><input type="checkbox" id="chkSimple"> Simple (సాధారణ వడ్డీ)</label>
    <label><input type="checkbox" id="chkCompound" checked> Compound (చక్రవడ్డీ)</label>
  </div>
  <div class="small" style="margin-bottom:8px;">
    (Choose one or both. By default Compound is selected.)
  </div>

  <div class="input-group">
    <label>Amount:</label>
    <input type="text" id="first" placeholder="Amount" />
  </div>
  <div class="input-group">
    <label>Years:</label>
    <input type="text" id="second" placeholder="Years" value="0" />
  </div>
  <div class="input-group">
    <label>Months:</label>
    <input type="text" id="third" placeholder="Months" value="0" />
  </div>
  <div class="input-group">
    <label>Days:</label>
    <input type="text" id="fourth" placeholder="Days" value="0" />
  </div>
  <div class="input-group">
    <label>Interest(%):</label>
    <input type="text" id="fifth" placeholder="Interest(%)" />
  </div>

  <button class="submit-btn" onclick="calculateInterest()">Calculate Interest</button>
  <div id="output"></div>
</div>

<script>
  // Format integer part with Indian grouping (e.g., 10,00,000)
  function formatIndianInteger(intStr) {
    intStr = intStr.replace(/^0+(?=\d)/, '');
    let n = intStr.length;
    if (n <= 3) return intStr;
    let last3 = intStr.slice(n - 3);
    let rest = intStr.slice(0, n - 3);
    let parts = [];
    while (rest.length > 2) {
      parts.unshift(rest.slice(-2));
      rest = rest.slice(0, -2);
    }
    if (rest.length > 0) parts.unshift(rest);
    return parts.join(',') + ',' + last3;
  }

  // Format numeric string to Indian format and optionally fix decimals up to 2 places
  function formatIndianNumberRaw(raw) {
    if (raw === '' || raw === '.' ) return '';
    raw = raw.replace(/[^0-9.]/g, '');
    let parts = raw.split('.');
    let intPart = parts[0] || '0';
    let decPart = parts[1] || '';
    if (decPart.length > 2) decPart = decPart.slice(0,2);
    let intFormatted = formatIndianInteger(intPart);
    return decPart ? intFormatted + '.' + decPart : intFormatted;
  }

  function formatCurrencyForDisplay(num) {
    if (isNaN(num) || num === null) return '₹0.00';
    let fixed = Number(num).toFixed(2);
    let parts = fixed.split('.');
    return '₹' + formatIndianInteger(parts[0]) + '.' + parts[1];
  }

  function parseCurrencyInput(val) {
    if (!val && val !== 0) return 0;
    let cleaned = String(val).replace(/[^0-9.]/g, '');
    if (cleaned === '') return 0;
    const dots = cleaned.split('.');
    if (dots.length > 2) {
      cleaned = dots.shift() + '.' + dots.join('');
    }
    let parsed = parseFloat(cleaned);
    return isNaN(parsed) ? 0 : parsed;
  }

  // Live-format the Amount input to Indian grouping with ₹
  const amountInput = document.getElementById('first');
  amountInput.addEventListener('input', (e) => {
    const raw = amountInput.value;
    const cleaned = raw.replace(/[^0-9.]/g, '');
    const parts = cleaned.split('.');
    let intPart = parts[0] || '';
    let decPart = parts[1] || '';
    if (decPart.length > 2) decPart = decPart.slice(0,2);
    const formattedInt = intPart === '' ? '' : formatIndianInteger(intPart);
    const display = formattedInt + (decPart ? '.' + decPart : '');
    amountInput.value = display ? '₹' + display : '';
    amountInput.selectionStart = amountInput.selectionEnd = amountInput.value.length;
  });

  amountInput.addEventListener('blur', () => {
    const rawNum = parseCurrencyInput(amountInput.value);
    amountInput.value = formatCurrencyForDisplay(rawNum);
  });

  amountInput.addEventListener('focus', () => {
    const rawNum = parseCurrencyInput(amountInput.value);
    amountInput.value = rawNum ? '₹' + formatIndianNumberRaw(String(rawNum)) : '';
    amountInput.selectionStart = amountInput.selectionEnd = amountInput.value.length;
  });

  // Calculate Period from Dates and autofill years, months, days
  function calculatePeriod() {
    let startVal = document.getElementById("startDate").value;
    let endVal = document.getElementById("endDate").value;

    if (!startVal || !endVal) {
      document.getElementById("periodOutput").innerHTML = "Please select both dates.";
      return;
    }

    let start = new Date(startVal);
    let end = new Date(endVal);

    if (end < start) {
      document.getElementById("periodOutput").innerHTML = "End date must be after start date.";
      return;
    }

    let years = end.getFullYear() - start.getFullYear();
    let months = end.getMonth() - start.getMonth();
    let days = end.getDate() - start.getDate();

    if (days < 0) {
      months--;
      let prevMonthDays = new Date(end.getFullYear(), end.getMonth(), 0).getDate();
      days += prevMonthDays;
    }
    if (months < 0) {
      years--;
      months += 12;
    }

    document.getElementById("periodOutput").innerHTML =
      `Time Period: ${years} Years, ${months} Months, ${days} Days`;

    document.getElementById("second").value = years;
    document.getElementById("third").value = months;
    document.getElementById("fourth").value = days;
  }

  // Calculate selected interest types
  function calculateInterest() {
    const chkSimple = document.getElementById('chkSimple').checked;
    const chkCompound = document.getElementById('chkCompound').checked;

    if (!chkSimple && !chkCompound) {
      document.getElementById("output").innerHTML = "Please select at least one interest type.";
      return;
    }

    let p = parseCurrencyInput(document.getElementById("first").value);
    let t1 = parseFloat(document.getElementById("second").value);
    let t2 = parseFloat(document.getElementById("third").value);
    let t3 = parseFloat(document.getElementById("fourth").value);
    let r = parseFloat(document.getElementById("fifth").value);

    if (isNaN(p) || p === undefined || p === 0) p = 100000;
    if (isNaN(t1) || t1 === undefined) t1 = 0;
    if (isNaN(t2) || t2 === undefined) t2 = 0;
    if (isNaN(t3) || t3 === undefined) t3 = 0;
    if (isNaN(r) || r === undefined) r = 18;

    if ([p, t1, t2, t3, r].some(v => isNaN(v))) {
      document.getElementById("output").innerHTML = "Please enter valid input values.";
      return;
    }

    let outParts = [];

    if (chkCompound) {
      let amount1 = p * Math.pow(1 + r / 100, t1);
      let amount2 = (t2 * amount1 * r) / 1200;
      let amount3 = (amount1 * r * t3) / 36000;
      let totalCompound = amount1 + amount2 + amount3;
      let ci = totalCompound - p;

      outParts.push(
        `<div><strong>Compound (చక్రవడ్డీ):</strong></div>` +
        `<div>Interest (వడ్డీ): ${formatCurrencyForDisplay(ci)}</div>` +
        `<div>Total Amount (మొత్తం విలువ): ${formatCurrencyForDisplay(totalCompound)}</div>`
      );
    }

    if (chkSimple) {
      let totalYears = t1 + (t2 / 12) + (t3 / 365);
      let si = (p * r * totalYears) / 100;
      let totalSimple = p + si;

      outParts.push(
        `<div><strong>Simple (సాధారణ వడ్డీ):</strong></div>` +
        `<div>Interest (వడ్డీ): ${formatCurrencyForDisplay(si)}</div>` +
        `<div>Total Amount (మొత్తం విలువ): ${formatCurrencyForDisplay(totalSimple)}</div>`
      );
    }

    document.getElementById("output").innerHTML = outParts.join('<hr class="responsive">');
  }

  // Initialize defaults on load
  window.addEventListener('DOMContentLoaded', () => {
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    const iso = `${yyyy}-${mm}-${dd}`;
    document.getElementById('endDate').value = iso;
    document.getElementById('startDate').value = '';
    document.getElementById('periodOutput').innerHTML = '';

    document.getElementById('first').value = formatCurrencyForDisplay(100000);
    document.getElementById('fifth').value = 18;
  });
</script>

</body>
</html>
